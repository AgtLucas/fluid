// Generated by purs version 0.11.7
"use strict";
var Control_Alt = require("../Control.Alt");
var Control_Applicative = require("../Control.Applicative");
var Control_Bind = require("../Control.Bind");
var Control_Monad_Except_Trans = require("../Control.Monad.Except.Trans");
var Data_Array = require("../Data.Array");
var Data_Bifunctor = require("../Data.Bifunctor");
var Data_Either = require("../Data.Either");
var Data_Foreign = require("../Data.Foreign");
var Data_Foreign_Index = require("../Data.Foreign.Index");
var Data_Function = require("../Data.Function");
var Data_Identity = require("../Data.Identity");
var Data_List_Types = require("../Data.List.Types");
var Data_Maybe = require("../Data.Maybe");
var Data_Show = require("../Data.Show");
var Data_StrMap = require("../Data.StrMap");
var Data_Symbol = require("../Data.Symbol");
var Data_Traversable = require("../Data.Traversable");
var Data_Tuple = require("../Data.Tuple");
var Data_Unfoldable = require("../Data.Unfoldable");
var Prelude = require("../Prelude");
var Simple_JSON = require("../Simple.JSON");
var Type_Row = require("../Type.Row");
var Type = (function () {
    function Type(value0) {
        this.value0 = value0;
    };
    Type.create = function (value0) {
        return new Type(value0);
    };
    return Type;
})();
var MemberDecl = (function () {
    function MemberDecl(value0) {
        this.value0 = value0;
    };
    MemberDecl.create = function (value0) {
        return new MemberDecl(value0);
    };
    return MemberDecl;
})();
var EnumDecl = (function () {
    function EnumDecl(value0) {
        this.value0 = value0;
    };
    EnumDecl.create = function (value0) {
        return new EnumDecl(value0);
    };
    return EnumDecl;
})();
var TypeDecl$primeHollow = (function () {
    function TypeDecl$primeHollow(value0) {
        this.value0 = value0;
    };
    TypeDecl$primeHollow.create = function (value0) {
        return new TypeDecl$primeHollow(value0);
    };
    return TypeDecl$primeHollow;
})();
var TypeDecl$primeWrap = (function () {
    function TypeDecl$primeWrap(value0) {
        this.value0 = value0;
    };
    TypeDecl$primeWrap.create = function (value0) {
        return new TypeDecl$primeWrap(value0);
    };
    return TypeDecl$primeWrap;
})();
var TypeDecl$primeEnum = (function () {
    function TypeDecl$primeEnum(value0) {
        this.value0 = value0;
    };
    TypeDecl$primeEnum.create = function (value0) {
        return new TypeDecl$primeEnum(value0);
    };
    return TypeDecl$primeEnum;
})();
var TypeDecl$primeStruct = (function () {
    function TypeDecl$primeStruct(value0) {
        this.value0 = value0;
    };
    TypeDecl$primeStruct.create = function (value0) {
        return new TypeDecl$primeStruct(value0);
    };
    return TypeDecl$primeStruct;
})();
var readTypeString = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign.readString(value))(function (v) {
        return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new Type({
            n: v,
            p: Data_Maybe.Nothing.value
        }));
    });
};
var readTypeDeclWrapString = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(readTypeString(value))(function (v) {
        return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new TypeDecl$primeWrap({
            w: v,
            o: Data_Maybe.Nothing.value
        }));
    });
};
var readTypeParams = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign.readArray(value))(function (v) {
        return Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(readType)(v);
    });
};
var readTypeParam = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(readType(value))(function (v) {
        return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))([ v ]);
    });
};
var readTypeObject = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("n"))(Data_Foreign.readString))(function (v) {
        var $30 = Data_Foreign_Index.hasProperty(Data_Foreign_Index.indexString)("p")(value);
        if ($30) {
            return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("p"))(function (v1) {
                return Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(readTypeParam(v1))(readTypeParams(v1));
            }))(function (v1) {
                return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new Type({
                    n: v,
                    p: new Data_Maybe.Just(v1)
                }));
            });
        };
        return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new Type({
            n: v,
            p: Data_Maybe.Nothing.value
        }));
    });
};
var readType = function (value) {
    return Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(readTypeString(value))(readTypeObject(value));
};
var readForeignType = new Simple_JSON.ReadForeign(readType);
var readMaybeOutput = function (value) {
    var $32 = Data_Foreign_Index.hasProperty(Data_Foreign_Index.indexString)("o")(value);
    if ($32) {
        return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("o"))(Simple_JSON.readImpl(readForeignType)))(function (v) {
            return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new Data_Maybe.Just(v));
        });
    };
    return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(Data_Maybe.Nothing.value);
};
var readTypeDeclWrapObject = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("w"))(readTypeString))(function (v) {
        return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(readMaybeOutput(value))(function (v1) {
            return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new TypeDecl$primeWrap({
                w: v,
                o: v1
            }));
        });
    });
};
var readTypeDeclWrap = function (value) {
    return Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(readTypeDeclWrapString(value))(readTypeDeclWrapObject(value));
};
var readMemberDecl = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Simple_JSON.readImpl(Simple_JSON.readStrMap(readForeignType))(value))(function (v) {
        var v1 = Data_StrMap.toUnfoldable(Data_Unfoldable.unfoldableArray)(v);
        if (v1.length === 0) {
            return Data_Foreign.fail(new Data_Foreign.ForeignError("No object"));
        };
        if (v1.length === 1) {
            return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new MemberDecl({
                name: v1[0].value0,
                ty: v1[0].value1
            }));
        };
        return Data_Foreign.fail(new Data_Foreign.ForeignError("Must be singleton object"));
    });
};
var readTypeDeclHollow = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("o"))(Simple_JSON.readImpl(readForeignType)))(function (v) {
        return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new TypeDecl$primeHollow({
            o: v
        }));
    });
};
var readForeignMemberDecl = new Simple_JSON.ReadForeign(readMemberDecl);
var readTypeDeclStruct = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("m"))(Data_Foreign.readArray))(function (v) {
        return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(Simple_JSON.readImpl(readForeignMemberDecl))(v))(function (v1) {
            return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(readMaybeOutput(value))(function (v2) {
                return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new TypeDecl$primeStruct({
                    m: v1,
                    o: v2
                }));
            });
        });
    });
};
var readEnumDeclString = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign.readString(value))(function (v) {
        return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new EnumDecl({
            tag: v,
            m: Data_Maybe.Nothing.value
        }));
    });
};
var readEnumDeclObject = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("tag"))(Data_Foreign.readString))(function (v) {
        return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))((function () {
            var $47 = Data_Foreign_Index.hasProperty(Data_Foreign_Index.indexString)("m")(value);
            if ($47) {
                return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("m"))(Data_Foreign.readArray))(function (v1) {
                    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(Simple_JSON.readImpl(readForeignMemberDecl))(v1))(function (v2) {
                        return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))((function () {
                            var $50 = Data_Array["null"](v2);
                            if ($50) {
                                return Data_Maybe.Nothing.value;
                            };
                            return new Data_Maybe.Just(v2);
                        })());
                    });
                });
            };
            return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(Data_Maybe.Nothing.value);
        })())(function (v1) {
            return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new EnumDecl({
                tag: v,
                m: v1
            }));
        });
    });
};
var readEnumDecl = function (value) {
    return Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(readEnumDeclString(value))(readEnumDeclObject(value));
};
var readForeignEnumDecl = new Simple_JSON.ReadForeign(readEnumDecl);
var readTypeDeclEnumArray = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign.readArray(value))(function (v) {
        return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(Simple_JSON.readImpl(readForeignEnumDecl))(v))(function (v1) {
            return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new TypeDecl$primeEnum({
                e: v1,
                o: Data_Maybe.Nothing.value
            }));
        });
    });
};
var readTypeDeclEnumObject = function (value) {
    return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Foreign_Index.ix(Data_Foreign_Index.indexableForeign)(Data_Foreign_Index.indexString)(value)("e"))(Data_Foreign.readArray))(function (v) {
        return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(Simple_JSON.readImpl(readForeignEnumDecl))(v))(function (v1) {
            return Control_Bind.bind(Control_Monad_Except_Trans.bindExceptT(Data_Identity.monadIdentity))(readMaybeOutput(value))(function (v2) {
                return Control_Applicative.pure(Control_Monad_Except_Trans.applicativeExceptT(Data_Identity.monadIdentity))(new TypeDecl$primeEnum({
                    e: v1,
                    o: v2
                }));
            });
        });
    });
};
var readTypeDeclEnum = function (value) {
    return Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(readTypeDeclEnumArray(value))(readTypeDeclEnumObject(value));
};
var readTypeDecl = function (value) {
    return Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(Control_Alt.alt(Control_Monad_Except_Trans.altExceptT(Data_List_Types.semigroupNonEmptyList)(Data_Identity.monadIdentity))(readTypeDeclHollow(value))(readTypeDeclWrap(value)))(readTypeDeclEnum(value)))(readTypeDeclStruct(value));
};
var readForeignTypeDecl = new Simple_JSON.ReadForeign(readTypeDecl);
var parseSpec = function (s) {
    return Data_Bifunctor.lmap(Data_Either.bifunctorEither)(Data_Show.show(Data_List_Types.showNonEmptyList(Data_Foreign.showForeignError)))(Simple_JSON.readJSON(Simple_JSON.readRecord()(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "fluid";
    }))(Simple_JSON.readRecord()(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "major";
    }))(Simple_JSON.readInt)(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "minor";
    }))(Simple_JSON.readInt)(Simple_JSON.readFieldsNil)(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))()))(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "pull";
    }))(Simple_JSON.readRecord()(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "error";
    }))(readForeignType)(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "host";
    }))(Simple_JSON.readString)(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "name";
    }))(Simple_JSON.readString)(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "path";
    }))(Simple_JSON.readString)(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "port";
    }))(Simple_JSON.readInt)(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "protocol";
    }))(Simple_JSON.readString)(Simple_JSON.readFieldsNil)(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))()))(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "schema";
    }))(Simple_JSON.readStrMap(readForeignTypeDecl))(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "version";
    }))(Simple_JSON.readMaybe(Simple_JSON.readRecord()(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "major";
    }))(Simple_JSON.readInt)(Simple_JSON.readFieldsCons(new Data_Symbol.IsSymbol(function () {
        return "minor";
    }))(Simple_JSON.readInt)(Simple_JSON.readFieldsNil)(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))())))(Simple_JSON.readFieldsNil)(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))())(Type_Row.rowLacks()()()(Type_Row.rowLacking))()))(s));
};
module.exports = {
    Type: Type,
    readType: readType,
    readTypeString: readTypeString,
    readTypeObject: readTypeObject,
    readTypeParam: readTypeParam,
    readTypeParams: readTypeParams,
    "TypeDecl'Hollow": TypeDecl$primeHollow,
    "TypeDecl'Wrap": TypeDecl$primeWrap,
    "TypeDecl'Enum": TypeDecl$primeEnum,
    "TypeDecl'Struct": TypeDecl$primeStruct,
    readTypeDecl: readTypeDecl,
    readTypeDeclHollow: readTypeDeclHollow,
    readMaybeOutput: readMaybeOutput,
    readTypeDeclWrap: readTypeDeclWrap,
    readTypeDeclWrapString: readTypeDeclWrapString,
    readTypeDeclWrapObject: readTypeDeclWrapObject,
    readTypeDeclEnum: readTypeDeclEnum,
    readTypeDeclEnumArray: readTypeDeclEnumArray,
    readTypeDeclEnumObject: readTypeDeclEnumObject,
    readTypeDeclStruct: readTypeDeclStruct,
    EnumDecl: EnumDecl,
    readEnumDecl: readEnumDecl,
    readEnumDeclString: readEnumDeclString,
    readEnumDeclObject: readEnumDeclObject,
    MemberDecl: MemberDecl,
    readMemberDecl: readMemberDecl,
    parseSpec: parseSpec,
    readForeignType: readForeignType,
    readForeignTypeDecl: readForeignTypeDecl,
    readForeignEnumDecl: readForeignEnumDecl,
    readForeignMemberDecl: readForeignMemberDecl
};
